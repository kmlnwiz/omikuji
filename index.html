<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新春おみくじチャレンジ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* フォント */
        body {
            font-family: 'Noto Serif JP', serif;
            user-select: none;
        }

        /* カードフリップ（Tailwindでは不可） */
        .card-container { perspective: 1000px; }
        .card {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }
        .card.flipped { transform: rotateY(180deg); }
        .card-front, .card-back {
            position: absolute;
            inset: 0;
            backface-visibility: hidden;
        }
        .card-front { transform: rotateY(180deg); }

        /* 拡大カードアニメーション */
        .card-enlarge {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 520px;
            height: 630px;
            z-index: 100;
            animation: moveToCenter 0.6s ease-out forwards;
        }
        @keyframes moveToCenter {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.5) rotate(-10deg); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1) rotate(0deg); }
        }
        .card-enlarge .card { transform: rotateY(0deg); }
        .card-enlarge .card.flipped { transform: rotateY(180deg); }

        /* レアリティエフェクト */
        .effect-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 1200px;
            height: 1200px;
            pointer-events: none;
            z-index: 101;
            overflow: visible;
        }

        /* 光の放射エフェクト（大吉用） */
        .radial-burst {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            transform: translate(-50%, -50%);
            opacity: 0;
        }
        .radial-burst.active {
            animation: radialBurst 1.5s ease-out forwards;
        }
        @keyframes radialBurst {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.3); }
            20% { opacity: 1; }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(2); }
        }
        .radial-burst::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 600px;
            height: 600px;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle, rgba(255,215,0,1) 0%, rgba(255,180,0,0.8) 30%, rgba(255,215,0,0) 70%);
            border-radius: 50%;
        }

        /* 光線エフェクト（大吉用） */
        .light-rays {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 600px;
            height: 600px;
            transform: translate(-50%, -50%);
            opacity: 0;
        }
        .light-rays.active {
            animation: lightRaysAnim 2s ease-out forwards;
        }
        @keyframes lightRaysAnim {
            0% { opacity: 0; transform: translate(-50%, -50%) rotate(0deg) scale(0.5); }
            30% { opacity: 1; }
            100% { opacity: 0; transform: translate(-50%, -50%) rotate(180deg) scale(1.5); }
        }
        .light-ray {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 300px;
            background: linear-gradient(to top, rgba(255,215,0,1), rgba(255,180,0,0.6), rgba(255,215,0,0));
            transform-origin: bottom center;
            filter: blur(2px);
        }

        /* パーティクル */
        .particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0;
            box-shadow: 0 0 10px currentColor, 0 0 20px currentColor;
        }
        .particle.active {
            animation: particleFloat 2.5s ease-out forwards;
        }
        @keyframes particleFloat {
            0% { opacity: 1; transform: translate(0, 0) scale(1.2); }
            50% { opacity: 0.8; }
            100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0); }
        }

        /* キラキラエフェクト */
        .sparkle {
            position: absolute;
            width: 20px;
            height: 20px;
            opacity: 0;
        }
        .sparkle.active {
            animation: sparkleAnim 1s ease-out forwards;
        }
        @keyframes sparkleAnim {
            0% { opacity: 0; transform: scale(0) rotate(0deg); }
            50% { opacity: 1; transform: scale(1) rotate(180deg); }
            100% { opacity: 0; transform: scale(0) rotate(360deg); }
        }
        .sparkle::before, .sparkle::after {
            content: '';
            position: absolute;
            background: currentColor;
        }
        .sparkle::before {
            top: 50%;
            left: 0;
            width: 100%;
            height: 6px;
            transform: translateY(-50%);
            border-radius: 3px;
            box-shadow: 0 0 8px currentColor;
        }
        .sparkle::after {
            top: 0;
            left: 50%;
            width: 6px;
            height: 100%;
            transform: translateX(-50%);
            border-radius: 3px;
            box-shadow: 0 0 8px currentColor;
        }

        /* 柔らかい光エフェクト（吉・小吉用） */
        .soft-glow {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 500px;
            height: 500px;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            opacity: 0;
        }
        .soft-glow.active {
            animation: softGlowAnim 1.5s ease-out forwards;
        }
        @keyframes softGlowAnim {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            30% { opacity: 0.8; }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1.2); }
        }

        /* 紙吹雪エフェクト（大吉用） */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0;
        }
        .confetti.active {
            animation: confettiFall 3s ease-out forwards;
        }
        @keyframes confettiFall {
            0% { opacity: 1; transform: translate(0, 0) rotate(0deg); }
            100% { opacity: 0; transform: translate(var(--tx), var(--ty)) rotate(720deg); }
        }
    </style>
</head>
<body class="h-screen p-2 flex flex-col bg-amber-50 overflow-hidden">
    <div class="container mx-auto max-w-[1920px] w-full h-full flex flex-col">
        <!-- ヘッダー -->
        <header class="text-center py-1 shrink-0">

            <div class="flex items-center justify-center gap-2">
                <div class="w-12 h-0.5 bg-amber-900"></div>
                <div class="w-2 h-2 bg-amber-900 rotate-45"></div>
                <h1 class="text-4xl font-black tracking-widest text-amber-900">新春おみくじチャレンジ</h1>
                <div class="w-2 h-2 bg-amber-900 rotate-45"></div>
                <div class="w-12 h-0.5 bg-amber-900"></div>
            </div>
        </header>

        <!-- オーバーレイ -->
        <div id="overlay" class="hidden fixed inset-0 z-50 bg-black/75 backdrop-blur-sm"></div>

        <!-- 統計情報とボタン -->
        <div class="mb-1 flex items-center justify-between shrink-0">
            <div class="flex-1"></div>
            <div id="statsContainer" class="flex-1">
                <!-- 統計はJavaScriptで生成 -->
            </div>
            <div class="flex-1 flex justify-end gap-2">
                <button
                    id="fullscreenBtn"
                    class="bg-amber-700 hover:bg-amber-600 text-amber-50 font-bold py-1 px-3 text-sm rounded transition-all duration-300 shadow-lg hover:shadow-xl border-2 border-amber-800"
                >
                    全画面
                </button>
                <button
                    id="resetBtn"
                    class="bg-amber-900 hover:bg-amber-800 text-amber-50 font-bold py-1 px-3 text-sm rounded transition-all duration-300 shadow-lg hover:shadow-xl border-2 border-amber-950"
                >
                    最初から
                </button>
                <button
                    id="openAllBtn"
                    class="bg-red-700 hover:bg-red-600 text-amber-50 font-bold py-1 px-3 text-sm rounded transition-all duration-300 shadow-lg hover:shadow-xl border-2 border-red-800"
                >
                    すべて開く
                </button>
                <button
                    id="helpBtn"
                    class="bg-amber-600 hover:bg-amber-500 text-amber-50 font-bold py-1 px-3 text-sm rounded transition-all duration-300 shadow-lg hover:shadow-xl border-2 border-amber-700"
                >
                    ？
                </button>
            </div>
        </div>

        <!-- ヘルプモーダル -->
        <div id="helpModal" class="hidden fixed inset-0 z-[200] flex items-center justify-center">
            <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" id="helpModalOverlay"></div>
            <div class="relative bg-amber-50 rounded-lg shadow-2xl max-w-lg w-full mx-4 max-h-[80vh] overflow-y-auto border-4 border-amber-800">
                <div class="sticky top-0 bg-amber-800 text-amber-50 px-4 py-3 flex items-center justify-between">
                    <h3 class="text-xl font-black tracking-widest">使い方・仕様</h3>
                    <button id="helpCloseBtn" class="text-2xl font-bold hover:text-amber-200 transition-colors">&times;</button>
                </div>
                <div class="p-4 space-y-4 text-amber-900">
                    <section>
                        <h4 class="font-bold text-lg border-b border-amber-300 pb-1 mb-2">遊び方</h4>
                        <ol class="list-decimal list-inside space-y-1 text-sm">
                            <li>30枚のカードから好きな1枚を選んでクリック</li>
                            <li>カードがめくれて内容が表示されます</li>
                            <li>結果画面をクリックして閉じると次のカードを選べます</li>
                            <li>「これまでの結果」から過去の結果を再確認できます</li>
                        </ol>
                    </section>
                    <section>
                        <h4 class="font-bold text-lg border-b border-amber-300 pb-1 mb-2">レアリティの種類と出現枚数</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex items-center gap-2 p-2 rounded" style="background-color: #fff0f0; border: 2px solid #c83c3c;">
                                <span class="font-black text-lg" style="color: #8b0000;">大吉</span>
                                <span class="ml-auto font-bold">1枚</span>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded" style="background-color: #fff8f0; border: 2px solid #d4841c;">
                                <span class="font-black text-lg" style="color: #b8860b;">中吉</span>
                                <span class="ml-auto font-bold">4枚</span>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded" style="background-color: #f0fdf4; border: 2px solid #2d8b57;">
                                <span class="font-black text-lg" style="color: #006400;">吉</span>
                                <span class="ml-auto font-bold">10枚</span>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded" style="background-color: #f0f9ff; border: 2px solid #4682b4;">
                                <span class="font-black text-lg" style="color: #1e4d8b;">小吉</span>
                                <span class="ml-auto font-bold">15枚</span>
                            </div>
                        </div>
                    </section>
                    <section>
                        <h4 class="font-bold text-lg border-b border-amber-300 pb-1 mb-2">ボタン説明</h4>
                        <ul class="space-y-1 text-sm">
                            <li><span class="font-bold">全画面</span> - フルスクリーン表示に切り替え</li>
                            <li><span class="font-bold">最初から</span> - カードと履歴をリセット</li>
                        </ul>
                    </section>
                    <section>
                        <h4 class="font-bold text-lg border-b border-amber-300 pb-1 mb-2">仕様</h4>
                        <ul class="list-disc list-inside space-y-1 text-sm">
                            <li>カード枚数: 30枚（10列×3行）</li>
                            <li>カード番号は漢数字で表示</li>
                            <li>レアリティに応じた演出エフェクト付き</li>
                            <li>FHD（1920×1080）に最適化</li>
                        </ul>
                    </section>
                </div>
            </div>
        </div>

        <!-- カードグリッド -->
        <div id="cardGrid" class="grid grid-cols-10 grid-rows-3 gap-1 flex-1 min-h-0 overflow-hidden">
            <!-- カードはJavaScriptで生成 -->
        </div>

        <!-- 拡大カード用コンテナ -->
        <div id="enlargedCardContainer"></div>

        <!-- エフェクト用コンテナ（カードの上） -->
        <div id="effectContainer" class="effect-container"></div>

    </div>

    <script type="module" src="omikuji.js"></script>
</body>
</html>
